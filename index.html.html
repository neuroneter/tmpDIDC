<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema CI/CD WordPress - Presentaci√≥n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .presentation-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .tabs-container {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
            overflow-x: auto;
        }

        .tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 0.9em;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            background: #e9ecef;
            color: #495057;
        }

        .tab.active {
            color: #0078D4;
            background: white;
            border-bottom-color: #0078D4;
        }

        .content {
            min-height: 700px;
            padding: 30px;
        }

        .step-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .step-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .step-number {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #0078D4, #005A9E);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: bold;
            margin-right: 20px;
        }

        .step-title {
            flex: 1;
        }

        .step-title h2 {
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .step-title p {
            color: #6c757d;
            font-size: 1.1em;
        }

        .diagram-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .component {
            display: inline-block;
            margin: 10px;
            padding: 20px;
            border-radius: 12px;
            min-width: 180px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .component.active {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border: 3px solid #ffc107;
        }

        .component.dev { background: linear-gradient(135deg, #4CAF50, #45a049); color: white; }
        .component.stage { background: linear-gradient(135deg, #FF9800, #f57c00); color: white; }
        .component.prod { background: linear-gradient(135deg, #f44336, #d32f2f); color: white; opacity: 0.6; }
        .component.jump { background: linear-gradient(135deg, #2196F3, #1976D2); color: white; }
        .component.azure { background: linear-gradient(135deg, #0078D4, #005A9E); color: white; }

        .flow-arrow {
            display: inline-block;
            margin: 0 10px;
            font-size: 2em;
            color: #28a745;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 25px;
        }

        .detail-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 4px solid #0078D4;
        }

        .detail-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .detail-card ul {
            list-style: none;
            padding: 0;
        }

        .detail-card li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            position: relative;
            padding-left: 25px;
        }

        .detail-card li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 15px 0;
        }

        .highlight {
            background: rgba(255, 193, 7, 0.2);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            margin: 15px 0;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .nav-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            background: #0078D4;
            color: white;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #005A9E;
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .architecture-overview {
            text-align: center;
            margin: 30px 0;
        }

        .environment-flow {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            margin: 30px 0;
        }

        @media (max-width: 768px) {
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs-container {
                flex-direction: column;
            }
            
            .tab {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="presentation-container">
        <div class="header">
            <h1>Sistema CI/CD WordPress</h1>
            <p>Despliegue Continuo Development ‚Üí Stage ‚Üí Production</p>
        </div>

        <div class="tabs-container">
            <button class="tab active" onclick="showStep(0)">Arquitectura</button>
            <button class="tab" onclick="showStep(1)">1. Trigger DevOps</button>
            <button class="tab" onclick="showStep(2)">2. Jump Server</button>
            <button class="tab" onclick="showStep(3)">3. Pre-Checks</button>
            <button class="tab" onclick="showStep(4)">4. Safety Backup</button>
            <button class="tab" onclick="showStep(5)">5. Migraci√≥n BD</button>
            <button class="tab" onclick="showStep(6)">6. Verificaci√≥n</button>
            <button class="tab" onclick="showStep(7)">7. Completado</button>
        </div>

        <div class="content">
            <!-- PASO 0: Arquitectura General -->
            <div class="step-content active">
                <div class="step-header">
                    <div class="step-number">üèóÔ∏è</div>
                    <div class="step-title">
                        <h2>Arquitectura del Sistema</h2>
                        <p>Vista general de componentes y flujos de despliegue</p>
                    </div>
                </div>

                <div class="architecture-overview">
                    <div class="environment-flow">
                        <div class="component dev">
                            <h3>Development</h3>
                            <p>172.16.4.4</p>
                            <small>/var/www/html/debweb</small>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="component stage">
                            <h3>Stage</h3>
                            <p>172.16.5.4</p>
                            <small>/var/www/html/webcirion</small>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="component prod">
                            <h3>Production</h3>
                            <p>(Futuro)</p>
                            <small>website.com</small>
                        </div>
                    </div>

                    <div style="margin: 30px 0;">
                        <div class="component azure" style="margin: 0 20px;">
                            <h3>Azure DevOps</h3>
                            <p>CI/CD Pipeline</p>
                        </div>
                        <div class="flow-arrow" style="transform: rotate(90deg);">‚Üì</div>
                        <div class="component jump" style="margin: 0 20px;">
                            <h3>Jump Server</h3>
                            <p>AZWEBCORP-JUMP</p>
                        </div>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>üîÑ Flujos de Despliegue</h3>
                        <ul>
                            <li><strong>C√≥digo (2%):</strong> Git commits, configs, themes</li>
                            <li><strong>Contenido (98%):</strong> Posts, p√°ginas, media via CMS</li>
                            <li><strong>Direcci√≥n:</strong> Dev ‚Üí Stage ‚Üí Prod</li>
                            <li><strong>Automatizaci√≥n:</strong> Azure DevOps Pipeline</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>üõ†Ô∏è Scripts Principales</h3>
                        <ul>
                            <li><strong>WordPressDeploymentManager.ps1:</strong> Orchestrador</li>
                            <li><strong>migrate-dev-to-stage.sh:</strong> Migraci√≥n completa</li>
                            <li><strong>pre-migration-check.sh:</strong> Verificaciones</li>
                            <li><strong>WP-CLI:</strong> Gesti√≥n WordPress</li>
                        </ul>
                    </div>
                </div>

                <div class="highlight">
                    <strong>üí° Concepto Clave:</strong> Sistema h√≠brido optimizado para WordPress donde tanto c√≥digo como contenido siguen el flujo tradicional de CI/CD, pero el 98% de cambios son contenido generado via CMS WordPress.
                </div>
            </div>

            <!-- PASO 1: Trigger desde Azure DevOps -->
            <div class="step-content">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">
                        <h2>Trigger desde Azure DevOps</h2>
                        <p>Inicio del proceso de despliegue autom√°tico</p>
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="component azure active">
                        <h3>Azure DevOps</h3>
                        <p>üöÄ Pipeline Ejecut√°ndose</p>
                        <small>Agent Pool: Jump-Server-Pool</small>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="component jump">
                        <h3>Jump Server</h3>
                        <p>Esperando instrucciones</p>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>üéØ Triggers de Despliegue</h3>
                        <ul>
                            <li><strong>Manual:</strong> Trigger manual desde DevOps</li>
                            <li><strong>Autom√°tico:</strong> Push a rama 'develop'</li>
                            <li><strong>Programado:</strong> Sync diario/semanal de contenido</li>
                            <li><strong>Emergencia:</strong> Despliegue hotfix</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>‚öôÔ∏è Configuraci√≥n Pipeline</h3>
                        <ul>
                            <li><strong>Agent Pool:</strong> Jump-Server-Pool</li>
                            <li><strong>Variable Group:</strong> WordPress-Secrets</li>
                            <li><strong>Environment:</strong> WordPress-Stage</li>
                            <li><strong>Timeout:</strong> 30 minutos</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# azure-pipelines.yml
trigger:
  branches:
    include:
      - develop
      - main

pool:
  name: 'Jump-Server-Pool'

variables:
  - group: WordPress-Secrets

stages:
  - stage: PreMigrationValidation
    jobs:
      - job: ValidateSystem
        steps:
          - task: PowerShell@2
            inputs:
              filePath: '$(System.DefaultWorkingDirectory)/scripts/WordPressDeploymentManager.ps1'
              arguments: '-Operation "pre-check"'
                </div>

                <div class="highlight">
                    <strong>üîÑ Proceso:</strong> DevOps detecta cambios ‚Üí Valida permisos ‚Üí Asigna agent del Jump Server ‚Üí Inicia pipeline con variables seguras
                </div>
            </div>

            <!-- PASO 2: Jump Server recibe el trabajo -->
            <div class="step-content">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">
                        <h2>Jump Server Toma Control</h2>
                        <p>Windows Server ejecuta PowerShell principal</p>
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="component azure">
                        <h3>Azure DevOps</h3>
                        <p>Pipeline activo</p>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="component jump active">
                        <h3>Jump Server</h3>
                        <p>üîß WordPressDeploymentManager.ps1</p>
                        <small>PowerShell + plink</small>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>üñ•Ô∏è Jump Server Specs</h3>
                        <ul>
                            <li><strong>OS:</strong> Windows Server</li>
                            <li><strong>Hostname:</strong> AZWEBCORP-JUMP</li>
                            <li><strong>PowerShell:</strong> v5.1+</li>
                            <li><strong>SSH Client:</strong> PuTTY/plink</li>
                            <li><strong>Azure CLI:</strong> Integraci√≥n cloud</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>üìÅ Scripts en Jump Server</h3>
                        <ul>
                            <li><strong>C:\Scripts\WordPress\</strong></li>
                            <li>WordPressDeploymentManager.ps1</li>
                            <li>migrate-dev-to-stage.sh</li>
                            <li>pre-migration-check.sh</li>
                            <li><strong>C:\Logs\WordPress\</strong></li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# PowerShell se ejecuta en Jump Server
PS C:\> .\WordPressDeploymentManager.ps1 -Operation "migrate"

[2025-08-05 14:30:22] [INFO] === WordPress Deployment Manager (FINAL) ===
[2025-08-05 14:30:22] [INFO] Operacion: migrate
[2025-08-05 14:30:22] [INFO] Jump Server: AZWEBCORP-JUMP
[2025-08-05 14:30:22] [INFO] Usuario: admwb
[2025-08-05 14:30:22] [INFO] plink Path: C:\Program Files\PuTTY\plink.exe
                </div>

                <div class="highlight">
                    <strong>üéØ Rol del Jump Server:</strong> Act√∫a como puente entre Azure DevOps (Windows) y los servidores WordPress (Linux), manejando SSH, credenciales y orchestraci√≥n completa.
                </div>
            </div>

            <!-- PASO 3: Pre-Checks -->
            <div class="step-content">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">
                        <h2>Verificaciones Previas</h2>
                        <p>Validaci√≥n completa antes de migraci√≥n</p>
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="component dev active">
                        <h3>Development</h3>
                        <p>üîç Validando WordPress</p>
                        <small>wp core is-installed</small>
                    </div>
                    <div class="component stage active">
                        <h3>Stage</h3>
                        <p>üîç Validando WordPress</p>
                        <small>wp db check</small>
                    </div>
                    <div class="component jump active">
                        <h3>Jump Server</h3>
                        <p>üîß Ejecutando checks</p>
                        <small>plink + SSH</small>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>‚úÖ Verificaciones Realizadas</h3>
                        <ul>
                            <li><strong>Conectividad SSH:</strong> ping + plink test</li>
                            <li><strong>WordPress Dev:</strong> core instalado + BD OK</li>
                            <li><strong>WordPress Stage:</strong> core instalado + BD OK</li>
                            <li><strong>Espacio disco:</strong> >1GB libre en ambos</li>
                            <li><strong>WP-CLI:</strong> Versi√≥n y funcionalidad</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>üõ†Ô∏è Herramientas de Validaci√≥n</h3>
                        <ul>
                            <li><strong>plink.exe:</strong> Conectividad SSH</li>
                            <li><strong>WP-CLI:</strong> wp core is-installed</li>
                            <li><strong>MySQL:</strong> wp db check</li>
                            <li><strong>Sistema:</strong> df -h (espacio disco)</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# Pre-checks ejecut√°ndose
[INFO] Verificando conectividad con plink...
[SUCCESS] Ping OK to Development
[SUCCESS] plink SSH OK to Development: Connection test OK
[SUCCESS] Ping OK to Stage  
[SUCCESS] plink SSH OK to Stage: Connection test OK

[INFO] Verificando WordPress en Development...
[SUCCESS] WP-CLI funcionando en Development con: php /home/admwb/wp-cli.phar
[SUCCESS] WordPress 6.8.2 funcionando en Development
[SUCCESS] Base de datos Development OK

[INFO] Verificando espacio en disco...
[SUCCESS] Espacio en disco suficiente
                </div>

                <div class="highlight">
                    <strong>‚ö†Ô∏è Punto de No Retorno:</strong> Si cualquier verificaci√≥n falla, el proceso se detiene aqu√≠. No se ejecuta migraci√≥n hasta que todos los pre-checks pasen.
                </div>
            </div>

            <!-- PASO 4: Safety Backup -->
            <div class="step-content">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">
                        <h2>Backup de Seguridad</h2>
                        <p>Respaldo completo antes de cualquier cambio</p>
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="component stage active">
                        <h3>Stage Server</h3>
                        <p>üíæ Creando backup</p>
                        <small>wp db export</small>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="component azure active">
                        <h3>Azure Storage</h3>
                        <p>‚òÅÔ∏è Guardando backup</p>
                        <small>sawebcorpdeveu2001</small>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>üíæ Proceso de Backup</h3>
                        <ul>
                            <li><strong>Base de Datos:</strong> wp db export completo</li>
                            <li><strong>Timestamp:</strong> stage_safety_backup_YYYYMMDD_HHMMSS.sql</li>
                            <li><strong>Ubicaci√≥n Local:</strong> /tmp/ en Stage Server</li>
                            <li><strong>Azure Storage:</strong> Container safety-backups/</li>
                            <li><strong>Retenci√≥n:</strong> 7 d√≠as</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>üîí Seguridad del Backup</h3>
                        <ul>
                            <li><strong>Verificaci√≥n:</strong> Integridad del archivo</li>
                            <li><strong>Compresi√≥n:</strong> Optimizaci√≥n de espacio</li>
                            <li><strong>Encriptaci√≥n:</strong> Azure Storage seguro</li>
                            <li><strong>Acceso:</strong> Solo cuentas autorizadas</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# Safety Backup en progreso
[INFO] Creando backup de seguridad de Stage
[SUCCESS] Backup de seguridad de BD creado

# Comando ejecutado en Stage Server:
cd /var/www/html/webcirion
wp db export /tmp/stage_safety_backup_20250805_143022.sql

# Subida a Azure Storage
az storage blob upload \
  --container-name 'dev-stage-migrations' \
  --name 'safety-backups/stage_safety_backup_20250805_143022.sql' \
  --file '/tmp/stage_safety_backup_20250805_143022.sql'

[SUCCESS] Backup de seguridad guardado
                </div>

                <div class="highlight">
                    <strong>üõ°Ô∏è Garant√≠a de Rollback:</strong> Este backup permite restaurar Stage completamente en caso de que la migraci√≥n falle. Es nuestra red de seguridad principal.
                </div>
            </div>

            <!-- PASO 5: Migraci√≥n de Base de Datos -->
            <div class="step-content">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">
                        <h2>Migraci√≥n de Base de Datos</h2>
                        <p>Transferencia completa Development ‚Üí Stage</p>
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="component dev active">
                        <h3>Development</h3>
                        <p>üì§ Exportando BD</p>
                        <small>wp db export + gzip</small>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="component stage active">
                        <h3>Stage</h3>
                        <p>üì• Importando BD</p>
                        <small>zcat | wp db import</small>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>üîÑ Proceso de Migraci√≥n</h3>
                        <ul>
                            <li><strong>Export:</strong> wp db export desde Development</li>
                            <li><strong>Compresi√≥n:</strong> gzip para optimizar transferencia</li>
                            <li><strong>Transferencia:</strong> scp entre servidores</li>
                            <li><strong>Import:</strong> zcat | wp db import en Stage</li>
                            <li><strong>Actualizaci√≥n URLs:</strong> search-replace autom√°tico</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>üîó Actualizaci√≥n de URLs</h3>
                        <ul>
                            <li><strong>De:</strong> dev.website.local</li>
                            <li><strong>A:</strong> web3stg.ciriontechnologies.com</li>
                            <li><strong>Herramienta:</strong> wp search-replace</li>
                            <li><strong>Verificaci√≥n:</strong> Dry-run previo</li>
                            <li><strong>Opciones WP:</strong> home + siteurl</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# Migraci√≥n en progreso
[INFO] Creando backup de Development para migraci√≥n
[SUCCESS] Backup de BD de Development creado
[SUCCESS] Backup de Development guardado en Azure

[INFO] Transfiriendo backup Development ‚Üí Stage  
[SUCCESS] Backup transferido exitosamente

[INFO] Migrando base de datos Development ‚Üí Stage
[SUCCESS] Base de datos importada en Stage

[INFO] Actualizando URLs Development ‚Üí Stage
[INFO] Analizando cambios de URL...
[INFO] Se encontraron 847 URLs para actualizar
[SUCCESS] URLs actualizadas: dev.website.local ‚Üí web3stg.ciriontechnologies.com

# WP-CLI commands ejecutados:
wp search-replace 'dev.website.local' 'web3stg.ciriontechnologies.com' --skip-columns=guid
wp option update home 'https://web3stg.ciriontechnologies.com'
wp option update siteurl 'https://web3stg.ciriontechnologies.com'
wp cache flush
wp rewrite flush
                </div>

                <div class="highlight">
                    <strong>üîÑ Migraci√≥n Completa:</strong> Todo el contenido de Development (posts, p√°ginas, configuraciones, media) ahora est√° disponible en Stage con URLs actualizadas para el ambiente correcto.
                </div>
            </div>

            <!-- PASO 6: Verificaci√≥n -->
            <div class="step-content">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">
                        <h2>Verificaci√≥n y Validaci√≥n</h2>
                        <p>Tests funcionales y rollback autom√°tico si falla</p>
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="component stage active">
                        <h3>Stage Server</h3>
                        <p>üîç Verificando WordPress</p>
                        <small>wp core is-installed</small>
                    </div>
                    <div class="component jump active">
                        <h3>Jump Server</h3>
                        <p>üåê Test HTTP 200</p>
                        <small>web3stg.ciriontechnologies.com</small>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>‚úÖ Tests de Verificaci√≥n</h3>
                        <ul>
                            <li><strong>WordPress Core:</strong> wp core is-installed</li>
                            <li><strong>Base de Datos:</strong> wp db check</li>
                            <li><strong>URLs:</strong> Verificar home_url y site_url</li>
                            <li><strong>HTTP Response:</strong> Status 200 del sitio</li>
                            <li><strong>Posts:</strong> Conteo de contenido migrado</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>üîÑ Rollback Autom√°tico</h3>
                        <ul>
                            <li><strong>Trigger:</strong> Cualquier test que falle</li>
                            <li><strong>Proceso:</strong> wp db import del safety backup</li>
                            <li><strong>Verificaci√≥n:</strong> WordPress funcional post-rollback</li>
                            <li><strong>Notificaci√≥n:</strong> Alert autom√°tico al equipo</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# Verificaci√≥n en progreso
[INFO] Verificando migraci√≥n
[SUCCESS] WordPress 6.8.2 funcionando en Stage
[SUCCESS] Base de datos Stage verificada
[SUCCESS] URLs verificadas correctamente
   - Home URL: https://web3stg.ciriontechnologies.com
   - Site URL: https://web3stg.ciriontechnologies.com
[INFO] Posts verificados: 234 publicados

[INFO] Verificando sitio Stage...
[SUCCESS] Sitio Stage responde correctamente (HTTP 200)

# Si algo fallara:
# [WARNING] Error en verificaci√≥n - Ejecutando rollback
# [INFO] Iniciando rollback de migraci√≥n
# [SUCCESS] Rollback completado - Stage restaurado
                </div>

                <div class="highlight">
                    <strong>üõ°Ô∏è Garant√≠a de Funcionamiento:</strong> Si cualquier verificaci√≥n falla, el sistema autom√°ticamente ejecuta rollback usando el safety backup, garantizando que Stage nunca quede en estado inconsistente.
                </div>
            </div>

            <!-- PASO 7: Completado -->
            <div class="step-content">
                <div class="step-header">
                    <div class="step-number">7</div>
                    <div class="step-title">
                        <h2>Despliegue Completado</h2>
                        <p>Limpieza, reportes y notificaciones finales</p>
                    </div>
                </div>

                <div class="diagram-container">
                    <div class="component dev">
                        <h3>Development</h3>
                        <p>‚úÖ Migraci√≥n exitosa</p>
                        <small>Archivos limpiados</small>
                    </div>
                    <div class="component stage active">
                        <h3>Stage</h3>
                        <p>üöÄ Contenido actualizado</p>
                        <small>web3stg.ciriontechnologies.com</small>
                    </div>
                    <div class="component azure active">
                        <h3>Azure DevOps</h3>
                        <p>üìä Pipeline completado</p>
                        <small>Reports disponibles</small>
                    </div>
                </div>

                <div class="details-grid">
                    <div class="detail-card">
                        <h3>üßπ Proceso de Limpieza</h3>
                        <ul>
                            <li><strong>Archivos temporales:</strong> Eliminados de /tmp/</li>
                            <li><strong>Backups antiguos:</strong> Limpieza autom√°tica >7 d√≠as</li>
                            <li><strong>Logs archivados:</strong> Guardados para auditor√≠a</li>
                            <li><strong>Cache limpiado:</strong> wp cache flush</li>
                        </ul>
                    </div>
                    <div class="detail-card">
                        <h3>üìä Reportes Generados</h3>
                        <ul>
                            <li><strong>Migration Report:</strong> JSON con detalles</li>
                            <li><strong>Logs completos:</strong> Cada paso documentado</li>
                            <li><strong>Azure Artifacts:</strong> Descargables desde DevOps</li>
                            <li><strong>M√©tricas:</strong> Duraci√≥n, √©xito, errores</li>
                        </ul>
                    </div>
                </div>

                <div class="code-block">
# Resultado final exitoso
[INFO] Limpiando archivos temporales
[SUCCESS] Limpieza completada

[INFO] Generando reporte de migraci√≥n  
[SUCCESS] Reporte guardado: migration_report_20250805_143022.json

[SUCCESS] RESULTADO: Migraci√≥n completada exitosamente
[INFO] Resumen de migraci√≥n:
   - ID: 20250805_143022
   - Duraci√≥n: 180s
   - Source: Development
   - Target: Stage  
   - Safety Backup: stage_safety_backup_20250805_143022.sql
   - Azure Container: dev-stage-migrations
   - Logs: /var/log/wp-migrations/migration_20250805_143022.log

##vso[task.complete result=Succeeded] Migraci√≥n Development ‚Üí Stage completada
                </div>

                <div class="highlight">
                    <strong>üéâ ¬°Despliegue Exitoso!</strong> El contenido de Development est√° ahora disponible en Stage. El equipo puede revisar y aprobar para el siguiente paso hacia Production.
                </div>

                <div class="detail-card" style="background: linear-gradient(135deg, #28a745, #20c997); color: white; margin-top: 20px;">
                    <h3>üöÄ Pr√≥ximos Pasos</h3>
                    <ul style="color: white;">
                        <li><strong>Review:</strong> Equipo revisa cambios en Stage</li>
                        <li><strong>Testing:</strong> QA ejecuta tests en Stage</li>
                        <li><strong>Approval:</strong> Aprobaci√≥n para Production</li>
                        <li><strong>Production Deploy:</strong> Mismo proceso hacia Prod</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="previousStep()" disabled>‚Üê Anterior</button>
            <button class="nav-btn" id="nextBtn" onclick="nextStep()">Siguiente ‚Üí</button>
        </div>
    </div>

    <script>
        let currentStep = 0;
        const totalSteps = 8;

        function showStep(stepIndex) {
            // Hide all step contents
            const steps = document.querySelectorAll('.step-content');
            steps.forEach(step => step.classList.remove('active'));

            // Hide all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Show selected step
            steps[stepIndex].classList.add('active');
            tabs[stepIndex].classList.add('active');

            currentStep = stepIndex;
            updateNavigationButtons();
        }

        function nextStep() {
            if (currentStep < totalSteps - 1) {
                showStep(currentStep + 1);
            }
        }

        function previousStep() {
            if (currentStep > 0) {
                showStep(currentStep - 1);
            }
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            prevBtn.disabled = currentStep === 0;
            nextBtn.disabled = currentStep === totalSteps - 1;

            if (currentStep === totalSteps - 1) {
                nextBtn.textContent = 'Finalizado ‚úì';
            } else {
                nextBtn.textContent = 'Siguiente ‚Üí';
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(event) {
            if (event.key === 'ArrowRight' && currentStep < totalSteps - 1) {
                nextStep();
            } else if (event.key === 'ArrowLeft' && currentStep > 0) {
                previousStep();
            }
        });

        // Initialize
        updateNavigationButtons();
    </script>
</body>
</html>